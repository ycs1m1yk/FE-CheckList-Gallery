import{d as j}from"./prosemirror-model.fc7226ba.js";import{b as G}from"./prosemirror-transform.d8dd870a.js";var m={};function M(i){return M=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},M(i)}function w(){return typeof Reflect!="undefined"&&Reflect.get?w=Reflect.get:w=function(r,t,n){var e=H(r,t);if(!!e){var a=Object.getOwnPropertyDescriptor(e,t);return a.get?a.get.call(arguments.length<3?r:n):a.value}},w.apply(this,arguments)}function H(i,r){for(;!Object.prototype.hasOwnProperty.call(i,r)&&(i=g(i),i!==null););return i}function T(i,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(r&&r.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),r&&I(i,r)}function I(i,r){return I=Object.setPrototypeOf||function(n,e){return n.__proto__=e,n},I(i,r)}function R(i){var r=Y();return function(){var n=g(i),e;if(r){var a=g(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return Q(this,e)}}function Q(i,r){if(r&&(M(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return X(i)}function X(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function Y(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function g(i){return g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},g(i)}function h(i,r){if(!(i instanceof r))throw new TypeError("Cannot call a class as a function")}function A(i,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,n.key,n)}}function p(i,r,t){return r&&A(i.prototype,r),t&&A(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}Object.defineProperty(m,"__esModule",{value:!0});var v=j,x=G,J=Object.create(null),l=function(){function i(r,t,n){h(this,i),this.$anchor=r,this.$head=t,this.ranges=n||[new W(r.min(t),r.max(t))]}return p(i,[{key:"anchor",get:function(){return this.$anchor.pos}},{key:"head",get:function(){return this.$head.pos}},{key:"from",get:function(){return this.$from.pos}},{key:"to",get:function(){return this.$to.pos}},{key:"$from",get:function(){return this.ranges[0].$from}},{key:"$to",get:function(){return this.ranges[0].$to}},{key:"empty",get:function(){for(var t=this.ranges,n=0;n<t.length;n++)if(t[n].$from.pos!=t[n].$to.pos)return!1;return!0}},{key:"content",value:function(){return this.$from.doc.slice(this.from,this.to,!0)}},{key:"replace",value:function(t){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:v.Slice.empty,e=n.content.lastChild,a=null,o=0;o<n.openEnd;o++)a=e,e=e.lastChild;for(var s=t.steps.length,u=this.ranges,c=0;c<u.length;c++){var f=u[c],y=f.$from,d=f.$to,B=t.mapping.slice(s);t.replaceRange(B.map(y.pos),B.map(d.pos),c?v.Slice.empty:n),c==0&&q(t,s,(e?e.isInline:a&&a.isTextblock)?-1:1)}}},{key:"replaceWith",value:function(t,n){for(var e=t.steps.length,a=this.ranges,o=0;o<a.length;o++){var s=a[o],u=s.$from,c=s.$to,f=t.mapping.slice(e),y=f.map(u.pos),d=f.map(c.pos);o?t.deleteRange(y,d):(t.replaceRangeWith(y,d,n),q(t,e,n.isInline?-1:1))}}},{key:"getBookmark",value:function(){return b.between(this.$anchor,this.$head).getBookmark()}}],[{key:"findFrom",value:function(t,n){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=t.parent.inlineContent?new b(t):S(t.node(0),t.parent,t.pos,t.index(),n,e);if(a)return a;for(var o=t.depth-1;o>=0;o--){var s=n<0?S(t.node(0),t.node(o),t.before(o+1),t.index(o),n,e):S(t.node(0),t.node(o),t.after(o+1),t.index(o)+1,n,e);if(s)return s}return null}},{key:"near",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return this.findFrom(t,n)||this.findFrom(t,-n)||new O(t.node(0))}},{key:"atStart",value:function(t){return S(t,t,0,0,1)||new O(t)}},{key:"atEnd",value:function(t){return S(t,t,t.content.size,t.childCount,-1)||new O(t)}},{key:"fromJSON",value:function(t,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");var e=J[n.type];if(!e)throw new RangeError("No selection type ".concat(n.type," defined"));return e.fromJSON(t,n)}},{key:"jsonID",value:function(t,n){if(t in J)throw new RangeError("Duplicate use of selection JSON ID "+t);return J[t]=n,n.prototype.jsonID=t,n}}]),i}();l.prototype.visible=!0;var W=p(function i(r,t){h(this,i),this.$from=r,this.$to=t}),D=!1;function F(i){!D&&!i.parent.inlineContent&&(D=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+i.parent.type.name+")"))}var b=function(i){T(t,i);var r=R(t);function t(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:n;return h(this,t),F(n),F(e),r.call(this,n,e)}return p(t,[{key:"$cursor",get:function(){return this.$anchor.pos==this.$head.pos?this.$head:null}},{key:"map",value:function(e,a){var o=e.resolve(a.map(this.head));if(!o.parent.inlineContent)return l.near(o);var s=e.resolve(a.map(this.anchor));return new t(s.parent.inlineContent?s:o,o)}},{key:"replace",value:function(e){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:v.Slice.empty;if(w(g(t.prototype),"replace",this).call(this,e,a),a==v.Slice.empty){var o=this.$from.marksAcross(this.$to);o&&e.ensureMarks(o)}}},{key:"eq",value:function(e){return e instanceof t&&e.anchor==this.anchor&&e.head==this.head}},{key:"getBookmark",value:function(){return new z(this.anchor,this.head)}},{key:"toJSON",value:function(){return{type:"text",anchor:this.anchor,head:this.head}}}],[{key:"fromJSON",value:function(e,a){if(typeof a.anchor!="number"||typeof a.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new t(e.resolve(a.anchor),e.resolve(a.head))}},{key:"create",value:function(e,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:a,s=e.resolve(a);return new this(s,o==a?s:e.resolve(o))}},{key:"between",value:function(e,a,o){var s=e.pos-a.pos;if((!o||s)&&(o=s>=0?1:-1),!a.parent.inlineContent){var u=l.findFrom(a,o,!0)||l.findFrom(a,-o,!0);if(u)a=u.$head;else return l.near(a,o)}return e.parent.inlineContent||(s==0?e=a:(e=(l.findFrom(e,-o,!0)||l.findFrom(e,o,!0)).$anchor,e.pos<a.pos!=s<0&&(e=a))),new t(e,a)}}]),t}(l);l.jsonID("text",b);var z=function(){function i(r,t){h(this,i),this.anchor=r,this.head=t}return p(i,[{key:"map",value:function(t){return new i(t.map(this.anchor),t.map(this.head))}},{key:"resolve",value:function(t){return b.between(t.resolve(this.anchor),t.resolve(this.head))}}]),i}(),k=function(i){T(t,i);var r=R(t);function t(n){var e;h(this,t);var a=n.nodeAfter,o=n.node(0).resolve(n.pos+a.nodeSize);return e=r.call(this,n,o),e.node=a,e}return p(t,[{key:"map",value:function(e,a){var o=a.mapResult(this.anchor),s=o.deleted,u=o.pos,c=e.resolve(u);return s?l.near(c):new t(c)}},{key:"content",value:function(){return new v.Slice(v.Fragment.from(this.node),0,0)}},{key:"eq",value:function(e){return e instanceof t&&e.anchor==this.anchor}},{key:"toJSON",value:function(){return{type:"node",anchor:this.anchor}}},{key:"getBookmark",value:function(){return new Z(this.anchor)}}],[{key:"fromJSON",value:function(e,a){if(typeof a.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new t(e.resolve(a.anchor))}},{key:"create",value:function(e,a){return new t(e.resolve(a))}},{key:"isSelectable",value:function(e){return!e.isText&&e.type.spec.selectable!==!1}}]),t}(l);k.prototype.visible=!1;l.jsonID("node",k);var Z=function(){function i(r){h(this,i),this.anchor=r}return p(i,[{key:"map",value:function(t){var n=t.mapResult(this.anchor),e=n.deleted,a=n.pos;return e?new z(a,a):new i(a)}},{key:"resolve",value:function(t){var n=t.resolve(this.anchor),e=n.nodeAfter;return e&&k.isSelectable(e)?new k(n):l.near(n)}}]),i}(),O=function(i){T(t,i);var r=R(t);function t(n){return h(this,t),r.call(this,n.resolve(0),n.resolve(n.content.size))}return p(t,[{key:"replace",value:function(e){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:v.Slice.empty;if(a==v.Slice.empty){e.delete(0,e.doc.content.size);var o=l.atStart(e.doc);o.eq(e.selection)||e.setSelection(o)}else w(g(t.prototype),"replace",this).call(this,e,a)}},{key:"toJSON",value:function(){return{type:"all"}}},{key:"map",value:function(e){return new t(e)}},{key:"eq",value:function(e){return e instanceof t}},{key:"getBookmark",value:function(){return ee}}],[{key:"fromJSON",value:function(e){return new t(e)}}]),t}(l);l.jsonID("all",O);var ee={map:function(){return this},resolve:function(r){return new O(r)}};function S(i,r,t,n,e){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1;if(r.inlineContent)return b.create(i,t);for(var o=n-(e>0?0:1);e>0?o<r.childCount:o>=0;o+=e){var s=r.child(o);if(s.isAtom){if(!a&&k.isSelectable(s))return k.create(i,t-(e<0?s.nodeSize:0))}else{var u=S(i,s,t+e,e<0?s.childCount:0,e,a);if(u)return u}t+=s.nodeSize*e}return null}function q(i,r,t){var n=i.steps.length-1;if(!(n<r)){var e=i.steps[n];if(e instanceof x.ReplaceStep||e instanceof x.ReplaceAroundStep){var a=i.mapping.maps[n],o;a.forEach(function(s,u,c,f){o==null&&(o=f)}),i.setSelection(l.near(i.doc.resolve(o),t))}}}var K=1,_=2,C=4,V=function(i){T(t,i);var r=R(t);function t(n){var e;return h(this,t),e=r.call(this,n.doc),e.curSelectionFor=0,e.updated=0,e.meta=Object.create(null),e.time=Date.now(),e.curSelection=n.selection,e.storedMarks=n.storedMarks,e}return p(t,[{key:"selection",get:function(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}},{key:"setSelection",value:function(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|K)&~_,this.storedMarks=null,this}},{key:"selectionSet",get:function(){return(this.updated&K)>0}},{key:"setStoredMarks",value:function(e){return this.storedMarks=e,this.updated|=_,this}},{key:"ensureMarks",value:function(e){return v.Mark.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}},{key:"addStoredMark",value:function(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}},{key:"removeStoredMark",value:function(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}},{key:"storedMarksSet",get:function(){return(this.updated&_)>0}},{key:"addStep",value:function(e,a){w(g(t.prototype),"addStep",this).call(this,e,a),this.updated=this.updated&~_,this.storedMarks=null}},{key:"setTime",value:function(e){return this.time=e,this}},{key:"replaceSelection",value:function(e){return this.selection.replace(this,e),this}},{key:"replaceSelectionWith",value:function(e){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=this.selection;return a&&(e=e.mark(this.storedMarks||(o.empty?o.$from.marks():o.$from.marksAcross(o.$to)||v.Mark.none))),o.replaceWith(this,e),this}},{key:"deleteSelection",value:function(){return this.selection.replace(this),this}},{key:"insertText",value:function(e,a,o){var s=this.doc.type.schema;if(a==null)return e?this.replaceSelectionWith(s.text(e),!0):this.deleteSelection();if(o==null&&(o=a),o=o==null?a:o,!e)return this.deleteRange(a,o);var u=this.storedMarks;if(!u){var c=this.doc.resolve(a);u=o==a?c.marks():c.marksAcross(this.doc.resolve(o))}return this.replaceRangeWith(a,o,s.text(e,u)),this.selection.empty||this.setSelection(l.near(this.selection.$to)),this}},{key:"setMeta",value:function(e,a){return this.meta[typeof e=="string"?e:e.key]=a,this}},{key:"getMeta",value:function(e){return this.meta[typeof e=="string"?e:e.key]}},{key:"isGeneric",get:function(){for(var e in this.meta)return!1;return!0}},{key:"scrollIntoView",value:function(){return this.updated|=C,this}},{key:"scrolledIntoView",get:function(){return(this.updated&C)>0}}]),t}(x.Transform);function $(i,r){return!r||!i?i:i.bind(r)}var N=p(function i(r,t,n){h(this,i),this.name=r,this.init=$(t.init,n),this.apply=$(t.apply,n)}),te=[new N("doc",{init:function(r){return r.doc||r.schema.topNodeType.createAndFill()},apply:function(r){return r.doc}}),new N("selection",{init:function(r,t){return r.selection||l.atStart(t.doc)},apply:function(r){return r.selection}}),new N("storedMarks",{init:function(r){return r.storedMarks||null},apply:function(r,t,n,e){return e.selection.$cursor?r.storedMarks:null}}),new N("scrollToSelection",{init:function(){return 0},apply:function(r,t){return r.scrolledIntoView?t+1:t}})],E=p(function i(r,t){var n=this;h(this,i),this.schema=r,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=te.slice(),t&&t.forEach(function(e){if(n.pluginsByKey[e.key])throw new RangeError("Adding different instances of a keyed plugin ("+e.key+")");n.plugins.push(e),n.pluginsByKey[e.key]=e,e.spec.state&&n.fields.push(new N(e.key,e.spec.state,e))})}),ne=function(){function i(r){h(this,i),this.config=r}return p(i,[{key:"schema",get:function(){return this.config.schema}},{key:"plugins",get:function(){return this.config.plugins}},{key:"apply",value:function(t){return this.applyTransaction(t).state}},{key:"filterTransaction",value:function(t){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,e=0;e<this.config.plugins.length;e++)if(e!=n){var a=this.config.plugins[e];if(a.spec.filterTransaction&&!a.spec.filterTransaction.call(a,t,this))return!1}return!0}},{key:"applyTransaction",value:function(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};for(var n=[t],e=this.applyInner(t),a=null;;){for(var o=!1,s=0;s<this.config.plugins.length;s++){var u=this.config.plugins[s];if(u.spec.appendTransaction){var c=a?a[s].n:0,f=a?a[s].state:this,y=c<n.length&&u.spec.appendTransaction.call(u,c?n.slice(c):n,f,e);if(y&&e.filterTransaction(y,s)){if(y.setMeta("appendedTransaction",t),!a){a=[];for(var d=0;d<this.config.plugins.length;d++)a.push(d<s?{state:e,n:n.length}:{state:this,n:0})}n.push(y),e=e.applyInner(y),o=!0}a&&(a[s]={state:e,n:n.length})}}if(!o)return{state:e,transactions:n}}}},{key:"applyInner",value:function(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");for(var n=new i(this.config),e=this.config.fields,a=0;a<e.length;a++){var o=e[a];n[o.name]=o.apply(t,this[o.name],this,n)}return n}},{key:"tr",get:function(){return new V(this)}},{key:"reconfigure",value:function(t){for(var n=new E(this.schema,t.plugins),e=n.fields,a=new i(n),o=0;o<e.length;o++){var s=e[o].name;a[s]=this.hasOwnProperty(s)?this[s]:e[o].init(t,a)}return a}},{key:"toJSON",value:function(t){var n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(function(s){return s.toJSON()})),t&&M(t)=="object")for(var e in t){if(e=="doc"||e=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");var a=t[e],o=a.spec.state;o&&o.toJSON&&(n[e]=o.toJSON.call(a,this[a.key]))}return n}}],[{key:"create",value:function(t){for(var n=new E(t.doc?t.doc.type.schema:t.schema,t.plugins),e=new i(n),a=0;a<n.fields.length;a++)e[n.fields[a].name]=n.fields[a].init(t,e);return e}},{key:"fromJSON",value:function(t,n,e){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");var a=new E(t.schema,t.plugins),o=new i(a);return a.fields.forEach(function(s){if(s.name=="doc")o.doc=v.Node.fromJSON(t.schema,n.doc);else if(s.name=="selection")o.selection=l.fromJSON(o.doc,n.selection);else if(s.name=="storedMarks")n.storedMarks&&(o.storedMarks=n.storedMarks.map(t.schema.markFromJSON));else{if(e)for(var u in e){var c=e[u],f=c.spec.state;if(c.key==s.name&&f&&f.fromJSON&&Object.prototype.hasOwnProperty.call(n,u)){o[s.name]=f.fromJSON.call(c,t,n[u],o);return}}o[s.name]=s.init(t,o)}}),o}}]),i}();function L(i,r,t){for(var n in i){var e=i[n];e instanceof Function?e=e.bind(r):n=="handleDOMEvents"&&(e=L(e,r,{})),t[n]=e}return t}var re=function(){function i(r){h(this,i),this.spec=r,this.props={},r.props&&L(r.props,this,this.props),this.key=r.key?r.key.key:U("plugin")}return p(i,[{key:"getState",value:function(t){return t[this.key]}}]),i}(),P=Object.create(null);function U(i){return i in P?i+"$"+ ++P[i]:(P[i]=0,i+"$")}var ie=function(){function i(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"key";h(this,i),this.key=U(r)}return p(i,[{key:"get",value:function(t){return t.config.pluginsByKey[this.key]}},{key:"getState",value:function(t){return t[this.key]}}]),i}(),se=m.AllSelection=O,ue=m.EditorState=ne,ce=m.NodeSelection=k,le=m.Plugin=re,fe=m.PluginKey=ie,he=m.Selection=l,pe=m.SelectionRange=W,ve=m.TextSelection=b;m.Transaction=V;export{se as A,ue as E,ce as N,fe as P,he as S,ve as T,le as a,pe as b,m as d};
